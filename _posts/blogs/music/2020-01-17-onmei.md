---
layout: blog-child
title: 機能和声の実装 － 音名
date: 2020-01-17
excerpt: "音名のクラスを実装します。"
blog: true
parent: kinou-wasei/
prev-child: henkakigou/
tags: [音楽,機能和声,C++]
---

<table>
  <tr>
    <th>
      <h2>数式での翻訳</h2>
    </th>
  </tr>
</table>

幹音と変化記号の連結である文字列を、幹音と変化記号の組と同一視する。幹音と変化記号の組全体の集合
\\[
\textrm{OnMei} = \textrm{KanOn} \times \textrm{HenkaKigou}
\\]
に属する文字列を***音名***と呼びます。定義から、音名には可算無限種類の文字列があります。


<table>
  <tr>
    <th>
      <h2>C++での宣言</h2>
    </th>
  </tr>
</table>

音名のクラス`OnMei`および関係する関数たちを以下のように宣言します。

~~~c++

class OnMei
{

private:
  KanOn m_N;
  HenkaKigou m_S;
  Mod<12> m_num;

public:
  inline OnMei( const KanOn& N ) noexcept;
  inline OnMei( const KanOn& N , const HenkaKigou& S ) noexcept;
  
  inline string Display() const noexcept;
  inline const KanOn& GetKanOn() const noexcept;
  inline const HenkaKigou& GetHenkaKigou() const noexcept;
  inline const Mod<12>& GetNum() const noexcept;
  
  static int KanOnToInt( const KanOn& N ) noexcept;

};

inline bool operator==( const OnMei& N1 , const OnMei& N2 ) noexcept;
inline bool operator!=( const OnMei& N1 , const OnMei& N2 ) noexcept;

~~~


<table>
  <tr>
    <th>
      <h2>C++での定義</h2>
    </th>
  </tr>
</table>

実際の実装例については[こちら](https://github.com/p-adic/cpp/tree/master/Music/OnMei)をご覧下さい。実装においては以下の仕様を要請します。
- `inline OnMei::OnMei( const KanOn& N ) noexcept`は移譲コンストラクタ`OnMei::OnMei( N , HenkaKigou( 0 ) )`で定める。
- `inline OnMei::OnMei( const KanOn& N , const HenkaKigou& S ) noexcept`はメンバ初期化子リスト`m_N( N )` , `m_S( S )` , `m_num( KanOnToInt( N ) )`で定める。
- `inline string OnMei::Display() const noexcept`は`m_N.Display() + m_S.Display()`で定める。
- `inline const KanOn& OnMei::GetKanOn() const noexcept`は`OnMei::m_N`への参照返しである。
- `inline const HenkaKigou& OnMei::GetHenkaKigou() const noexcept`は`OnMei::m_S`への参照返しである。
- `inline const OnMei::Mod<12>& GetNum() const noexcept`は`OnMei::m_num`への参照返しである。
- `static int OnMei::KanOnToInt( const KanOn& N ) noexcept`は引数`Do()`～`Ti()`に対してそれぞれ`0` , `2` , `4` , `5` , `7` , `11`を返す。
- クラス`OnMei`に対する等号演算子は自然なものである。
