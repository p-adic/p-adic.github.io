---
layout: blog-child
title: 機能和声の実装 － 幹音
date: 2020-01-12
excerpt: "幹音のクラスを実装します。"
blog: true
parent: kinou-wasei/
tags: [音楽,機能和声,C++]
---

<table>
  <tr>
    <th>
      <h2>数式での翻訳</h2>
    </th>
  </tr>
</table>

英語のアルファベットを記号とする文字列の集合
\\[
\textrm{KanOn} = \\{\textrm{Do},\textrm{Re},\textrm{Mi},\textrm{Fa},\textrm{So},\textrm{La},\textrm{Ti}\\}
\\]
に属する文字列を***幹音***と呼びます。定義から、幹音にはちょうど７種類の文字列があります。完全に公理的集合論で定義をしたい場合は、英語のアルファベットを以下の規則で自然数にコードすることで、$$\mathbb{N}$$を記号とする文字列の集合に翻訳して下さい。
\\[
\begin{align}
\textrm{D} & := 0 \\\\\
\textrm{R} & := 1 \\\\\
\textrm{M} & := 2 \\\\\
\textrm{F} & := 3 \\\\\
\textrm{S} & := 4 \\\\\
\textrm{L} & := 5 \\\\\
\textrm{T} & := 6 \\\\\
\textrm{o} & := 7 \\\\\
\textrm{e} & := 8 \\\\\
\textrm{i} & := 9 \\\\\
\textrm{a} & := 10
\end{align}
\\]
ただし集合$$X$$を記号とする文字列というのは、写像$$f$$であって以下の条件を満たすもののことです：
1. ある$$n \in \mathbb{N}$$が存在し、$$f$$の定義域が$$\{i \in \mathbb{N} \mid i \lneq n\}$$である。
1. $$f$$の終域が$$X$$である。

特にこの流儀では空列も文字列となりますが、今回は長さ$$2$$の文字列しか扱っていないため空列の扱いを気にする必要はありません。


<table>
  <tr>
    <th>
      <h2>C++での宣言</h2>
    </th>
  </tr>
</table>

幹音のクラス`KanOn`および関係する関数たちを以下のように宣言します。

~~~c++

class KanOn
{

private:
  string m_N;
  uint m_num;

public:
  inline KanOn( const string& N );
  inline KanOn( const uint& num );

  inline const string& Display() const noexcept;
  inline const uint& GetNum() const noexcept;
  
  static uint StringToInt( const string& N );
  static const string& IntToString( const uint& num );

};

bool operator==( const KanOn& N1 , const KanOn& N2 );
inline bool operator!=( const KanOn& N1 , const KanOn& N2 );

const KanOn& Do();
const KanOn& Re();
const KanOn& Mi();
const KanOn& Fa();
const KanOn& So();
const KanOn& La();
const KanOn& Ti();
inline const KanOn& KanOnTable( const string& N );
const KanOn& KanOnTable( const uint& num );

~~~


<table>
  <tr>
    <th>
      <h2>C++での定義</h2>
    </th>
  </tr>
</table>

実際の実装例については[こちら](https://github.com/p-adic/cpp/tree/master/Music/OnMei/KanOn)をご覧下さい。実装においては以下の仕様を要請します。
- `inline KanOn::KanOn( const string& N )`はメンバ初期化子リスト`m_N( N ) , m_num( StringToInt( N ) )`で与える。
- `inline KanOn::KanOn( const uint& num )`はメンバ初期化子リスト`m_N( IntToString( num ) ) , m_num( num )`で与える。
- `inline const string& KanOn::Display() const noexcept`は`KanOn::m_N`への参照返しである。
- `inline const uint& KanOn::GetNum() const noexcept`は`KanOn::m_num`への参照返しである。
- クラス`KanOn`に対する等号演算子は自然なものである。
- `const KanOn& Do()`～`const KanOn& Ti()`は関数名から自然に連想される$$\textrm{KanOn}$$の元である文字列を`KanOn::Display()`で返す静的変数への参照返しである。
- `inline const KanOn& KanOnTable( const string& N )`は`KanOnTable( KanOn::StringToInt( N ) )`で定める。
- `const KanOn& KanOnTable( const uint& num )`は`Do()`～`Ti()`のうち`num`番目の関数の戻り値で定める。
