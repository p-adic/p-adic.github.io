---
layout: 404
title: 辺更新価値最大化
order: F
difficulty: ★★★
date: 2024-10-04
blog-class: yukicoder-contest-449
aname: yukicoder2915
num: 2915
tester: Shirotsumeさん
tags: [競技プログラミング,数学]
---

<p>
E問題と似たような問題設定ですが、今度は辺の重み付けに関して少し制約が変わっており、正閉路がないことが保証されています。$N$が小さいので今度こそベルマンフォード法！　……と言いたいところですが$Q$が大きいとやはり計算量が大きくなります。
</p>
<p>
ここで注目すべきは、クエリごとにグラフの辺の重みが変わらず、辺の削除と追加が起こるだけという点です。これはフローなどで残余ネットワークを考える時と似た状況ですね。
</p>
<p>
そして実際にPrimal Dual法の実装では負辺を許す状況でも工夫してダイクストラ法が使われていたことを思い出せば、同様にポテンシャルを用いたダイクストラ法で高速に処理できることが分かります。
</p>
<p>
というわけで実質Primal Dual法の理解を問う問題だったというわけですね。Primal Dual法は★3で基本的に問われませんが、<a href="https://yukicoder.me/problems/no/2604">No.2604 Initial Motion</a>という前例があるのでそのupsolveの前準備として役立てていただければ幸いです。
</p>
