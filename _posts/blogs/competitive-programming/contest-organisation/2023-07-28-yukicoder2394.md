---
layout: 404
title: 部分和乗総和
order: C
difficulty: ★★☆
date: 2023-07-28
blog-class: yukicoder-contest-399
aname: yukicoder2394
num: 2394
tester: hotman78さん、hiro1729さん（C・D全体tester）
tags: [競技プログラミング,数学]
---

<p>
※<a href="https://x.com/yukicoder/status/1887865883261079783">yukicoderさん公式の難易度再設定プロジェクト</a>により難易度が★2.5から★2に変更されました。
</p>
<p>
整数論ですが、アイデアの背景には組合せ論と可換環論があります。もし$M$が不定元$X$であれば、競技プログラミング典型の部分和問題です。適当な法のもとでなら冪乗の和を積に分解することで畳み込みに帰着させる高速な解法が知られており、そういった競技プログラミングにおける畳み込み事情を初めて学んだのは<a href="https://qiita.com/hotman78/items/f0e6d2265badd84d429a">testerさんの解説記事</a>でした。今からおよそ11ヶ月前。競技プログラミングの勉強を初めて間もない頃で、今でも当時の感銘は記憶に新しいです。
</p>
<p>
話が逸れましたが、この問題では多項式と整数の類似性をきちんと活かせるかを問いました。畳み込みによる部分和問題の解法を知っている人なら不定元$X$の代わりに$M$を考えるだけなので、体係数多項式環の代わりに整数環を使えばいいだけです。可換環論では体係数多項式環と整数環の類似性に注目した議論が多く、この問題も多項式の係数表示と整数の$M$進法表示の類似性に着目して思いつきました。
</p>
<p>
もちろん★2.5では畳み込みが典型ではないので畳み込みを知っている人しか解けないのでは難易度過小詐称になってしまいますが、本問は★2.5の典型手法である動的計画法でも解くことができます。これは部分和問題が優しい制約なら動的計画法で解ける（そしてその遷移の高速化に畳み込みが使える）という事実と対応していますね。
</p>
<p>
コンテスト本番は解法を思いついていながらもオーバーフローしたり$M$と$B$の役割を逆にしたりという提出がそこそこあったようです。何度も「あれもこれもあってそうなのに何で通ってないの！？」と不安になりテストケースに不備がないか確認していました。
</p>
