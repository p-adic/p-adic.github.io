---
layout: 404
title: 正閉路検出
order: E
difficulty: ★★★
date: 2024-10-04
blog-class: yukicoder-contest-449
aname: yukicoder2914
num: 2914
tester: Shirotsumeさん
tags: [競技プログラミング,数学]
---

<p>
負閉路検出と言えばベルマンフォード法。今回は正閉路検出なので、重みを$-1$倍にすればよいですね。……と思いきや計算量が大きすぎます。別の方法を考えましょう。
</p>
<p>
正閉路がないということは、$2$ 点間を結ぶ経路の重みの総和が一定ということ。つまり重みと整合的なポテンシャル（スカラー場）が存在するということです。重みと整合的なポテンシャルの有無の判定にはポテンシャル付き素集合データ構造が使えますね。
</p>
<p>
この問題のように進行方向を逆転させる辺の重みが$-1$倍でかかる設定（例えば非常に特殊な連立一次方程式など）ではポテンシャル付き素集合データ構造が使えること、を問う問題でした。
</p>
